<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vendor Dashboard - Dhamaka</title>
<style>
body{font-family:Arial,sans-serif;background:#f8f9fa;color:#212529;margin:0;padding:0;}
header{background:#28a745;color:white;padding:1em;display:flex;justify-content:space-between;align-items:center;}
header h1{margin:0;}
header button{padding:0.5em 1em;border:none;border-radius:5px;background:#ffc107;color:#212529;cursor:pointer;}
.container{padding:1em;}
input,select,textarea{width:100%;padding:0.5em;margin:0.3em 0;border-radius:5px;border:1px solid #ccc;}
button.add,button.update,button.delete{padding:0.5em 1em;margin:0.3em;border:none;border-radius:5px;cursor:pointer;}
button.add{background:#28a745;color:white;}
button.update{background:#007bff;color:white;}
button.delete{background:#dc3545;color:white;}
table{width:100%;border-collapse:collapse;margin-top:1em;}
table,th,td{border:1px solid #ccc;}
th,td{padding:0.5em;text-align:center;}
</style>
</head>
<body>

<header>
<h1>Vendor Dashboard</h1>
<div>
<span id="vendorName"></span>
<button onclick="logout()">Logout</button>
</div>
</header>

<div class="container">
<h2>Add / Update Products</h2>
<input type="text" id="prodName" placeholder="Product Name">
<input type="text" id="prodCategory" placeholder="Category">
<input type="number" id="prodPrice" placeholder="Price">
<input type="number" id="prodStock" placeholder="Stock Quantity">
<select id="prodImage">
<option value="smartphone">Smartphone</option>
<option value="tshirt">T-Shirt</option>
<option value="sofa">Sofa</option>
<option value="laptop">Laptop</option>
<option value="jeans">Jeans</option>
<option value="headphones">Headphones</option>
</select>
<button class="add" onclick="addProduct()">Add Product</button>

<h2>My Products</h2>
<table id="productTable">
<thead>
<tr>
<th>Name</th>
<th>Category</th>
<th>Price</th>
<th>Stock</th>
<th>Image</th>
<th>Actions</th>
</tr>
</thead>
<tbody></tbody>
</table>
</div>

<script>
let currentVendor = JSON.parse(localStorage.getItem('currentVendor')||'null');
if(!currentVendor){
  alert("Please login first.");
  window.location.href='vendor-login.html';
}
document.getElementById('vendorName').innerText = currentVendor.name+" ("+currentVendor.id+")";

let products = JSON.parse(localStorage.getItem('products')||'[]');

function renderProducts(){
  let tbody = document.querySelector('#productTable tbody');
  tbody.innerHTML='';
  products.forEach((p,i)=>{
    if(p.vendorId===currentVendor.id){
      let tr = document.createElement('tr');
      tr.innerHTML=`<td>${p.name}</td>
                    <td>${p.category}</td>
                    <td>${p.price}</td>
                    <td>${p.stock}</td>
                    <td>${p.image}</td>
                    <td>
                    <button class="update" onclick="editProduct(${i})">Edit</button>
                    <button class="delete" onclick="deleteProduct(${i})">Delete</button>
                    </td>`;
      tbody.appendChild(tr);
    }
  });
}

function addProduct(){
  let name = document.getElementById('prodName').value.trim();
  let category = document.getElementById('prodCategory').value.trim();
  let price = parseFloat(document.getElementById('prodPrice').value);
  let stock = parseInt(document.getElementById('prodStock').value);
  let image = document.getElementById('prodImage').value;
  if(!name||!category||isNaN(price)||isNaN(stock)){ alert("Fill all fields"); return; }
  products.push({name,category,price,stock,image,vendorId:currentVendor.id});
  localStorage.setItem('products',JSON.stringify(products));
  renderProducts();
  document.getElementById('prodName').value='';
  document.getElementById('prodCategory').value='';
  document.getElementById('prodPrice').value='';
  document.getElementById('prodStock').value='';
}

function editProduct(i){
  let p = products[i];
  if(p.vendorId!==currentVendor.id){ alert("Not your product"); return; }
  document.getElementById('prodName').value = p.name;
  document.getElementById('prodCategory').value = p.category;
  document.getElementById('prodPrice').value = p.price;
  document.getElementById('prodStock').value = p.stock;
  document.getElementById('prodImage').value = p.image;
  products.splice(i,1); // remove old entry to update
  localStorage.setItem('products',JSON.stringify(products));
}

function deleteProduct(i){
  if(products[i].vendorId!==currentVendor.id){ alert("Not your product"); return; }
  products.splice(i,1);
  localStorage.setItem('products',JSON.stringify(products));
  renderProducts();
}

function logout(){
  localStorage.removeItem('currentVendor');
  window.location.href='vendor-login.html';
}

renderProducts();
</script>

</body>
</html>
