<!-- Product List Example -->
<div class="product" data-index="0">
  <h3>Product Name</h3>
  <p>Price: $100</p>
  <p>Stock: <span class="stock">10</span></p>
  <button onclick="addToCart(0)">Add to Cart</button>
  
  <!-- Reviews -->
  <div class="reviews">
    <h4>Reviews:</h4>
    <div class="review-list" id="reviews-0"></div>
    <input type="text" id="reviewName-0" placeholder="Your Name">
    <input type="text" id="reviewText-0" placeholder="Your Review">
    <select id="reviewRating-0">
      <option value="1">1★</option>
      <option value="2">2★</option>
      <option value="3">3★</option>
      <option value="4">4★</option>
      <option value="5">5★</option>
    </select>
    <button onclick="addReview(0)">Submit Review</button>
  </div>
</div>

<script>
let products = JSON.parse(localStorage.getItem("products") || '[]');
let reviews = JSON.parse(localStorage.getItem("reviews") || '{}'); // key: productIndex, value: array

function addReview(index) {
  const name = document.getElementById(`reviewName-${index}`).value;
  const text = document.getElementById(`reviewText-${index}`).value;
  const rating = parseInt(document.getElementById(`reviewRating-${index}`).value);
  if(!name || !text) return alert("Enter name and review");
  
  if(!reviews[index]) reviews[index] = [];
  reviews[index].push({name, text, rating});
  localStorage.setItem("reviews", JSON.stringify(reviews));
  renderReviews(index);
}

function renderReviews(index) {
  const reviewDiv = document.getElementById(`reviews-${index}`);
  reviewDiv.innerHTML = '';
  if(!reviews[index]) return;
  reviews[index].forEach((r, i) => {
    const div = document.createElement('div');
    div.innerHTML = `<b>${r.name}</b> (${r.rating}★): ${r.text} 
      <button onclick="deleteReview(${index},${i})">Delete</button>`;
    reviewDiv.appendChild(div);
  });
}

// Admin delete
function deleteReview(productIndex, reviewIndex) {
  if(!confirm("Delete this review?")) return;
  reviews[productIndex].splice(reviewIndex, 1);
  localStorage.setItem("reviews", JSON.stringify(reviews));
  renderReviews(productIndex);
}

// Stock Management
function updateStock(productIndex, newStock) {
  products[productIndex].stock = newStock;
  localStorage.setItem("products", JSON.stringify(products));
  document.querySelector(`.product[data-index='${productIndex}'] .stock`).innerText = newStock;
}

// Example cart check
function addToCart(index){
  if(products[index].stock <= 0) return alert("Out of stock");
  products[index].stock -= 1;
  updateStock(index, products[index].stock);
  alert("Added to cart");
}
</script>
