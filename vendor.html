<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vendor Panel - Dhamaka Daily Items</title>
<style>
*{box-sizing:border-box;margin:0;padding:0;}
body{font-family:Arial,sans-serif;background:#f7f7f7;color:#212529;transition:0.3s;}
body.dark{background:#121212;color:#ddd;}
header{background:#17a2b8;color:white;padding:1em;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;}
header h1{font-size:1.5em;}
nav a{color:white;margin-left:1em;text-decoration:none;font-weight:bold;transition:0.3s;}
nav a:hover{text-decoration:underline;color:#ffc107;}
nav button{margin-left:1em;cursor:pointer;}
.page{display:none;padding:1em;}
input,select,textarea,button{padding:0.5em;margin:0.3em 0;border-radius:5px;border:1px solid #ccc;}
button{background:#17a2b8;color:white;border:none;cursor:pointer;}
button:hover{background:#138496;}
.product-list{display:flex;flex-wrap:wrap;gap:1em;}
.product{border:1px solid #17a2b8;padding:1em;border-radius:10px;width:200px;position:relative;}
.badge{position:absolute;top:10px;left:10px;background:#ffc107;color:#000;padding:2px 6px;border-radius:4px;font-size:0.8em;}
</style>
</head>
<body>

<header>
<h1>Vendor Panel</h1>
<nav>
<button onclick="toggleDarkMode()">ðŸŒ™</button>
<button id="logoutBtn" style="display:none;" onclick="logout()">Logout</button>
</nav>
</header>

<div id="vendorLogin" class="page">
<h2>Vendor Login</h2>
<input type="text" id="vendorUsername" placeholder="Username">
<input type="password" id="vendorPassword" placeholder="Password">
<button onclick="vendorLogin()">Login</button>
<p id="vendorLoginMsg" style="color:red;"></p>
<p>New vendor? Register below (admin approval required)</p>
<input type="text" id="vendorRegName" placeholder="Name">
<input type="text" id="vendorRegPromo" placeholder="Promo Code">
<input type="password" id="vendorRegPass" placeholder="Password">
<button onclick="vendorRegister()">Register</button>
<p id="vendorRegMsg" style="color:red;"></p>
</div>

<div id="vendorDashboard" class="page">
<h2>Welcome, <span id="vendorName"></span></h2>
<p>Promo Code: <b><span id="vendorPromo"></span></b></p>
<p>Total Customers from Promo: <b><span id="vendorCustomerCount">0</span></b></p>

<h3>Add / Edit Product</h3>
<input type="text" id="productName" placeholder="Product Name">
<input type="text" id="productCategory" placeholder="Category">
<input type="number" id="productPrice" placeholder="Price">
<input type="number" id="productStock" placeholder="Stock">
<input type="text" id="productImage" placeholder="Image URL">
<select id="productBadge">
<option value="">No Badge</option>
<option value="New">New</option>
<option value="Sale">Sale</option>
<option value="Popular">Popular</option>
<option value="Best Seller">Best Seller</option>
<option value="Premium">Premium</option>
</select>
<button onclick="addProduct()">Add Product</button>

<h3>Your Products</h3>
<div class="product-list" id="vendorProductList"></div>
</div>

<script>
// ====== Data Storage ======
let vendors=JSON.parse(localStorage.getItem("vendors")||'[]');
let products=JSON.parse(localStorage.getItem("products")||'[]');
let loggedVendor=JSON.parse(localStorage.getItem("loggedVendor")||'null');

if(loggedVendor && loggedVendor.approved){ showPage('vendorDashboard'); renderVendorDashboard(); }
else{ showPage('vendorLogin'); }

function showPage(page){ document.querySelectorAll('.page').forEach(p=>p.style.display='none'); document.getElementById(page).style.display='block'; }

function toggleDarkMode(){ document.body.classList.toggle('dark'); }

// ====== Vendor Auth ======
function vendorRegister(){
let name=document.getElementById("vendorRegName").value.trim();
let promo=document.getElementById("vendorRegPromo").value.trim();
let pass=document.getElementById("vendorRegPass").value;
if(!name||!promo||!pass){ document.getElementById("vendorRegMsg").innerText="Fill all fields"; return; }
if(vendors.some(v=>v.name===name)){ document.getElementById("vendorRegMsg").innerText="Username exists"; return; }
vendors.push({id:vendors.length+1,name, password:pass, approved:false, promoCode:promo, customers:0});
localStorage.setItem("vendors",JSON.stringify(vendors));
document.getElementById("vendorRegMsg").innerText="Registered! Wait for admin approval";
}

function vendorLogin(){
let name=document.getElementById("vendorUsername").value.trim();
let pass=document.getElementById("vendorPassword").value.trim();
let vendor=vendors.find(v=>v.name===name && v.password===pass);
if(!vendor){ document.getElementById("vendorLoginMsg").innerText="Invalid credentials"; return; }
if(!vendor.approved){ document.getElementById("vendorLoginMsg").innerText="Not approved yet"; return; }
loggedVendor=vendor; localStorage.setItem("loggedVendor",JSON.stringify(loggedVendor));
showPage('vendorDashboard'); renderVendorDashboard();
}

function logout(){ loggedVendor=null; localStorage.removeItem("loggedVendor"); showPage('vendorLogin'); }

// ====== Vendor Dashboard ======
function renderVendorDashboard(){
if(!loggedVendor) return;
document.getElementById("vendorName").innerText=loggedVendor.name;
document.getElementById("vendorPromo").innerText=loggedVendor.promoCode;
document.getElementById("vendorCustomerCount").innerText=loggedVendor.customers||0;
renderVendorProducts();
}

// ====== Products ======
function addProduct(){
if(!loggedVendor) return;
let name=document.getElementById("productName").value.trim();
let category=document.getElementById("productCategory").value.trim();
let price=parseFloat(document.getElementById("productPrice").value);
let stock=parseInt(document.getElementById("productStock").value);
let image=document.getElementById("productImage").value.trim();
let badge=document.getElementById("productBadge").value;
if(!name||!category||isNaN(price)||isNaN(stock)){ alert("Fill valid product info"); return; }
products.push({id:products.length+1,name,category,price,stock,imageURL:image,badge,buyer:[],vendorId:loggedVendor.id,approved:false});
localStorage.setItem("products",JSON.stringify(products));
renderVendorProducts();
alert("Product added! Wait for admin approval");
document.getElementById("productName").value=''; document.getElementById("productCategory").value=''; document.getElementById("productPrice").value=''; document.getElementById("productStock").value=''; document.getElementById("productImage").value=''; document.getElementById("productBadge").value='';
}

function renderVendorProducts(){
const list=document.getElementById("vendorProductList"); list.innerHTML='';
products.filter(p=>p.vendorId===loggedVendor.id).forEach(p=>{
const div=document.createElement('div'); div.className='product';
let badgeHTML=p.badge?`<div class="badge">${p.badge}</div>`:'';
div.innerHTML=`${badgeHTML}<h4>${p.name}</h4><p>$${p.price}</p><p>Stock: ${p.stock}</p><p>Status: ${p.approved?'Approved':'Pending'}</p>`;
list.appendChild(div);
});
}
</script>
</body>
</html>
