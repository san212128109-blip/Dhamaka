<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vendor Panel</title>
<style>
body{font-family:Arial,sans-serif;margin:0;padding:0;background:#f0f2f5;}
header{background:#28a745;color:white;padding:1em;text-align:center;}
.container{padding:1em;}
input,button,select{padding:0.3em;margin:0.2em;}
section{background:white;margin:1em 0;padding:1em;border-radius:10px;box-shadow:0 0 5px rgba(0,0,0,0.2);}
table{width:100%;border-collapse:collapse;}
th,td{border:1px solid #ccc;padding:0.5em;text-align:center;}
button{cursor:pointer;}
</style>
</head>
<body>

<header>
<h1>Vendor Panel</h1>
<div id="loginDiv">
<input type="text" id="vendorName" placeholder="Vendor ID">
<input type="password" id="vendorPass" placeholder="Password">
<button onclick="loginVendor()">Login</button>
<p>WhatsApp: 01913821910</p>
</div>

<div id="panel" style="display:none;">
<p>Logged in as <span id="currentVendor"></span> | <button onclick="logoutVendor()">Logout</button></p>
<section>
<h2>Add Product</h2>
<input type="text" id="pname" placeholder="Product Name">
<input type="text" id="pcategory" placeholder="Category">
<input type="number" id="pprice" placeholder="Price">
<input type="number" id="pstock" placeholder="Stock">
<button onclick="addProduct()">Add</button>
</section>

<section>
<h2>Your Products (Pending Approval)</h2>
<table>
<tr><th>Name</th><th>Category</th><th>Price</th><th>Stock</th><th>Status</th></tr>
<tbody id="myProducts"></tbody>
</table>
</section>

<p>WhatsApp for support: 01913821910</p>
</div>

<script>
// Sample vendor accounts (you can add more)
let vendors=JSON.parse(localStorage.getItem("vendors")||'[]');
if(vendors.length===0){
  vendors=[{id:"vendor1",pass:"1234",status:"Pending",loginTime:null}];
  localStorage.setItem("vendors",JSON.stringify(vendors));
}

let currentVendor=null;

// Login
function loginVendor(){
  let id=document.getElementById("vendorName").value;
  let pass=document.getElementById("vendorPass").value;
  vendors=JSON.parse(localStorage.getItem("vendors")||'[]');
  let vendor=vendors.find(v=>v.id===id && v.pass===pass);
  if(!vendor) return alert("Invalid credentials");
  if(vendor.status!=="Approved") return alert("Wait for admin approval");
  currentVendor=vendor.id;
  document.getElementById("loginDiv").style.display="none";
  document.getElementById("panel").style.display="block";
  document.getElementById("currentVendor").innerText=currentVendor;

  // Set login time for 7-day trial if not already set
  if(!vendor.loginTime) {
    vendor.loginTime=Date.now();
    localStorage.setItem("vendors",JSON.stringify(vendors));
  }
  checkTrial();
  renderMyProducts();
}

// Logout
function logoutVendor(){
  currentVendor=null;
  document.getElementById("loginDiv").style.display="block";
  document.getElementById("panel").style.display="none";
}

// Add Product
function addProduct(){
  if(!currentVendor) return alert("Login first");
  let pname=document.getElementById("pname").value;
  let pcategory=document.getElementById("pcategory").value;
  let pprice=document.getElementById("pprice").value;
  let pstock=document.getElementById("pstock").value;
  if(!pname || !pcategory || !pprice || !pstock) return alert("Fill all fields");
  
  let products=JSON.parse(localStorage.getItem("products")||'[]');
  products.push({name:pname,category:pcategory,price:Number(pprice),stock:Number(pstock),status:"Pending",vendor:currentVendor});
  localStorage.setItem("products",JSON.stringify(products));
  renderMyProducts();
  alert("Product added. Waiting for admin approval.");
}

// Render vendor products
function renderMyProducts(){
  let products=JSON.parse(localStorage.getItem("products")||'[]');
  let myProds=products.filter(p=>p.vendor===currentVendor);
  let tbody=document.getElementById("myProducts");
  tbody.innerHTML='';
  myProds.forEach(p=>{
    let tr=document.createElement("tr");
    tr.innerHTML=`<td>${p.name}</td><td>${p.category}</td><td>${p.price}</td><td>${p.stock}</td><td>${p.status}</td>`;
    tbody.appendChild(tr);
  });
}

// Check 7-day trial
function checkTrial(){
  let vendor=vendors.find(v=>v.id===currentVendor);
  if(!vendor || !vendor.loginTime) return;
  let now=Date.now();
  let diff=(now - vendor.loginTime)/(1000*60*60*24);
  if(diff>7){
    alert("Your 7-day trial expired. Logging out.");
    logoutVendor();
  } else {
    setTimeout(checkTrial, 3600000); // check every hour
  }
}
</script>
</body>
</html>
