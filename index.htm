<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dhamaka Shop</title>
<style>
*{box-sizing:border-box;margin:0;padding:0;}
body{font-family:Arial,sans-serif;background:#f0f0f0;color:#333;transition:0.3s;}
body.dark{background:#121212;color:#ddd;}
header{background:#28a745;color:white;padding:1em;display:flex;justify-content:space-between;flex-wrap:wrap;align-items:center;position:sticky;top:0;z-index:10;}
header h1{margin:0;font-size:1.5em;}
nav{display:flex;align-items:center;flex-wrap:wrap;}
nav a{color:white;margin-left:1em;text-decoration:none;font-weight:bold;transition:0.3s;position:relative;}
nav a:hover{text-decoration:underline;color:#ffc107;}
nav #cartLink::after{content:attr(data-count);position:absolute;top:-10px;right:-10px;background:red;color:white;width:20px;height:20px;text-align:center;line-height:20px;border-radius:50%;font-size:0.8em;display:inline-block;}
nav button{margin-left:1em;cursor:pointer;}
.page{display:none;padding:1em;}
h1,h2,h3{text-align:center;margin-bottom:0.5em;}
.product-list,.cart-list{display:flex;flex-wrap:wrap;gap:1em;justify-content:center;margin-top:1em;}
.product{border:1px solid #28a745;border-radius:12px;padding:1em;width:200px;text-align:center;background:#fff;box-shadow:2px2px10px rgba(0,0,0,0.1);transition:0.3s;position:relative;overflow:hidden;}
.product:hover{transform:scale(1.05);box-shadow:4px4px15px rgba(0,0,0,0.2);}
.product img{transition: transform 0.3s;}
.product:hover img{transform:scale(1.2);}
button{background:#28a745;color:white;border:none;padding:0.5em 1em;border-radius:5px;cursor:pointer;margin-top:0.5em;transition:0.3s;}
button:hover{background:#218838;}
input,select{padding:0.5em;margin:0.3em 0;width:90%;border-radius:5px;border:1px solid #ccc;}
#cartSummary{text-align:center;margin-top:1em;font-weight:bold;}
.review{border-top:1px solid #ccc;margin-top:5px;padding-top:5px;}
#support{position:fixed;bottom:20px;right:20px;background:#25D366;color:white;padding:10px 15px;border-radius:50px;cursor:pointer;box-shadow:2px2px10px rgba(0,0,0,0.2);}
@media(max-width:600px){ .product{width:45%; } header{flex-direction:column;align-items:flex-start;} }
</style>
</head>
<body>
<header>
<h1>Dhamaka Shop</h1>
<nav>
<a href="#home" onclick="showPage('home')">Home</a>
<a id="cartLink" href="#cart" data-count="0" onclick="showPage('cart')">Cart</a>
<a href="#login" onclick="showPage('login')">Login</a>
<button onclick="toggleDarkMode()">ðŸŒ™</button>
</nav>
</header>

<!-- Pages -->
<div id="home" class="page">
<h2>Products</h2>
<input type="text" id="searchInput" placeholder="Search Products..." oninput="filterProducts()">
<div class="product-list" id="productList"></div>
</div>

<div id="cart" class="page">
<h2>Your Cart</h2>
<div class="cart-list" id="cartList"></div>
<div id="cartSummary"></div>
<button onclick="checkout()">Checkout</button>
</div>

<div id="login" class="page">
<h2>Customer Login</h2>
<input type="text" id="customerName" placeholder="Enter your name">
<button onclick="customerLogin()">Login</button>
<p id="loginMsg" style="color:red;"></p>
</div>

<script>
let products = JSON.parse(localStorage.getItem("products")||'[]');
let cart = JSON.parse(localStorage.getItem("cart")||'[]');
let reviews = JSON.parse(localStorage.getItem("reviews")||'[]');

function showPage(page){
  document.querySelectorAll('.page').forEach(p=>p.style.display='none');
  document.getElementById(page).style.display='block';
}
showPage('home');

function toggleDarkMode(){ document.body.classList.toggle('dark'); }

function renderProducts(){
  const list = document.getElementById('productList');
  list.innerHTML = '';
  products.forEach((p,i)=>{
    const div = document.createElement('div'); div.className='product';
    let productReviews = reviews.filter(r=>r.productId===p.id).map(r=>`<div class="review"><strong>${r.customer}:</strong> ${r.text}</div>`).join('');
    div.innerHTML=`<h3>${p.name}</h3>
    <p>Price: $${p.price}</p>
    <p>Stock: ${p.stock}</p>
    <button onclick="addToCart(${i})">Add to Cart</button>
    <input type="text" id="reviewInput${i}" placeholder="Add review">
    <button onclick="addReview(${i})">Review</button>
    ${productReviews}`;
    list.appendChild(div);
  });
}

function addToCart(i){
  if(products[i].stock>0){
    cart.push({...products[i]});
    products[i].stock--;
    localStorage.setItem("cart",JSON.stringify(cart));
    localStorage.setItem("products",JSON.stringify(products));
    alert("Added to cart!");
    renderProducts();
    renderCart();
  } else { alert("Out of stock!"); }
}

function renderCart(){
  const cartList = document.getElementById('cartList');
  const cartSummary = document.getElementById('cartSummary');
  cartList.innerHTML=''; let total=0;
  cart.forEach((c,i)=>{
    total+=c.price;
    const div=document.createElement('div'); div.className='product';
    div.innerHTML=`<p>${c.name} - $${c.price}</p>
    <button onclick="removeFromCart(${i})">Remove</button>`;
    cartList.appendChild(div);
  });
  cartSummary.innerText=`Total: $${total}`;
}

function removeFromCart(i){
  let pIndex = products.findIndex(p=>p.id===cart[i].id);
  products[pIndex].stock++;
  cart.splice(i,1);
  localStorage.setItem("cart",JSON.stringify(cart));
  localStorage.setItem("products",JSON.stringify(products));
  renderProducts(); renderCart();
}

function checkout(){
  if(cart.length===0){ alert("Cart is empty!"); return; }
  alert("Order placed successfully!");
  cart=[]; localStorage.setItem("cart",JSON.stringify(cart)); renderCart(); renderProducts();
}

function filterProducts(){
  const search = document.getElementById('searchInput').value.toLowerCase();
  const list = document.getElementById('productList');
  list.innerHTML='';
  products.filter(p=>p.name.toLowerCase().includes(search)).forEach((p,i)=>{
    const div=document.createElement('div'); div.className='product';
    div.innerHTML=`<h3>${p.name}</h3><p>Price: $${p.price}</p><p>Stock: ${p.stock}</p><button onclick="addToCart(${i})">Add to Cart</button>`;
    list.appendChild(div);
  });
}

function customerLogin(){
  let name=document.getElementById('customerName').value;
  if(name){ alert("Welcome "+name+"!"); showPage('home'); } 
  else{ document.getElementById('loginMsg').innerText="Enter your name"; }
}

function addReview(i){
  let text = document.getElementById(`reviewInput${i}`).value;
  if(!text) return alert("Enter review");
  reviews.push({productId:products[i].id, customer:document.getElementById('customerName').value||"Anonymous", text});
  localStorage.setItem("reviews",JSON.stringify(reviews));
  renderProducts();
}

// Initial setup if products empty
if(products.length===0){
  products=[{id:1,name:"Smartphone",price:200,stock:5},{id:2,name:"Laptop",price:500,stock:3}];
  localStorage.setItem("products",JSON.stringify(products));
}

renderProducts();
renderCart();
</script>
</body>
</html>
