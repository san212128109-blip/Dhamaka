<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Admin Panel</title>
<style>
  body{font-family:Arial, sans-serif;margin:0;padding:10px;background:#f6f8fa;}
  .wrap{max-width:900px;margin:0 auto}
  .card{background:#fff;padding:18px;margin:12px 0;border-radius:12px;box-shadow:0 6px 18px rgba(0,0,0,0.08)}
  h2,h3{margin:0 0 12px}
  input[type=password]{padding:8px;margin-right:8px;border-radius:6px;border:1px solid #ccc}
  button{padding:8px 12px;border-radius:6px;border:0;background:#28a745;color:#fff;cursor:pointer;margin:2px}
  .deny{background:#b21f2d}
  .list-item{padding:10px;border:1px solid #ddd;border-radius:8px;margin:6px 0;background:#fafafa}
  .section{margin-top:20px}
</style>
</head>
<body>

<div class="wrap">

  <div class="card" id="loginCard">
    <h2>Admin Login</h2>
    <input type="password" id="adminPass" placeholder="Enter Admin Password"/>
    <button onclick="adminLogin()">Login</button>
    <p id="loginMsg" style="color:red"></p>
  </div>

  <div id="adminPanel" style="display:none">

    <div class="card section">
      <h3>Pending Vendor Approvals</h3>
      <div id="pendingVendors"></div>
    </div>

    <div class="card section">
      <h3>Pending Products</h3>
      <div id="pendingProducts"></div>
    </div>

    <div class="card section">
      <h3>Approved Vendors</h3>
      <div id="approvedVendors"></div>
    </div>

    <div class="card section">
      <h3>Approved Products</h3>
      <div id="approvedProducts"></div>
    </div>

  </div>
</div>

<script>
// --- Admin login ---
function adminLogin(){
  const pass = document.getElementById('adminPass').value;
  if(pass === 'NAFIS128'){
    document.getElementById('loginCard').style.display='none';
    document.getElementById('adminPanel').style.display='block';
    loadData();
  } else{
    document.getElementById('loginMsg').innerText='Wrong password!';
  }
}

// --- localStorage helpers ---
function getVendors(){ return JSON.parse(localStorage.getItem('vendors')||'{}'); }
function setVendors(v){ localStorage.setItem('vendors', JSON.stringify(v)); }
function getPendingProducts(){ return JSON.parse(localStorage.getItem('pendingProducts')||'[]'); }
function setPendingProducts(p){ localStorage.setItem('pendingProducts', JSON.stringify(p)); }
function getApprovedProducts(){ return JSON.parse(localStorage.getItem('approvedProducts')||'[]'); }
function setApprovedProducts(p){ localStorage.setItem('approvedProducts', JSON.stringify(p)); }

// --- load all data ---
function loadData(){
  loadPendingVendors();
  loadPendingProducts();
  loadApprovedVendors();
  loadApprovedProducts();
}

// --- Pending Vendors ---
function loadPendingVendors(){
  const container = document.getElementById('pendingVendors');
  container.innerHTML = '';
  const vendors = getVendors();
  for(let id in vendors){
    if(!vendors[id].approved){
      const div = document.createElement('div');
      div.className='list-item';
      div.innerHTML=`<b>${vendors[id].name}</b> (ID: ${id})<br>
      Trial: 7 days<br>
      <button onclick="approveVendor('${id}')">Approve</button>
      <button class="deny" onclick="denyVendor('${id}')">Deny</button>`;
      container.appendChild(div);
    }
  }
  if(container.innerHTML===''){ container.innerHTML='<p>No pending vendors.</p>'; }
}

function approveVendor(id){
  const vendors = getVendors();
  vendors[id].approved=true;
  vendors[id].approvedAt=Date.now();
  setVendors(vendors);
  loadPendingVendors();
  loadApprovedVendors();
}

function denyVendor(id){
  const vendors = getVendors();
  delete vendors[id];
  setVendors(vendors);
  loadPendingVendors();
}

// --- Pending Products ---
function loadPendingProducts(){
  const container = document.getElementById('pendingProducts');
  container.innerHTML='';
  const list = getPendingProducts();
  if(list.length===0){ container.innerHTML='<p>No pending products.</p>'; return; }
  list.forEach((p,i)=>{
    const div=document.createElement('div');
    div.className='list-item';
    div.innerHTML=`<b>${p.name}</b> by Vendor ID: ${p.vendor}<br>
    ${p.desc}<br>
    <button onclick="approveProduct(${i})">Approve</button>
    <button class="deny" onclick="deleteProduct(${i})">Delete</button>`;
    container.appendChild(div);
  });
}

function approveProduct(i){
  const list = getPendingProducts();
  const approved = getApprovedProducts();
  approved.push(list[i]);
  setApprovedProducts(approved);
  list.splice(i,1);
  setPendingProducts(list);
  loadPendingProducts();
  loadApprovedProducts();
}

function deleteProduct(i){
  const list = getPendingProducts();
  list.splice(i,1);
  setPendingProducts(list);
  loadPendingProducts();
}

// --- Approved Vendors ---
function loadApprovedVendors(){
  const container = document.getElementById('approvedVendors');
  container.innerHTML='';
  const vendors = getVendors();
  for(let id in vendors){
    if(vendors[id].approved){
      const div = document.createElement('div');
      div.className='list-item';
      div.innerHTML=`<b>${vendors[id].name}</b> (ID: ${id})<br>
      Approved At: ${new Date(vendors[id].approvedAt).toLocaleString()}`;
      container.appendChild(div);
    }
  }
}

// --- Approved Products ---
function loadApprovedProducts(){
  const container = document.getElementById('approvedProducts');
  container.innerHTML='';
  const list = getApprovedProducts();
  if(list.length===0){ container.innerHTML='<p>No approved products.</p>'; return; }
  list.forEach(p=>{
    const div=document.createElement('div');
    div.className='list-item';
    div.innerHTML=`<b>${p.name}</b> by Vendor ID: ${p.vendor}<br>${p.desc}`;
    container.appendChild(div);
  });
}
</script>

</body>
</html>
