<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dhamaka Admin Dashboard</title>
<style>
/* Base Styles */
body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #1e1e1e; /* Dark background */
    color: #f0f0f0;
    margin: 0;
    padding: 0;
    display: flex;
    min-height: 100vh;
}
/* Header */
header {
    background: #007bff; /* Blue for contrast */
    color: white;
    padding: 1em;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.4);
    position: sticky;
    top: 0;
    z-index: 100;
    /* Added to span the width */
    width: 100%; 
}
header h1 { margin: 0; font-size: 1.5em; }
header button {
    background: #dc3545;
    border: none;
    padding: 8px 15px;
    border-radius: 5px;
    cursor: pointer;
    color: white;
    font-weight: bold;
}

/* Hamburger Icon Styling */
.hamburger {
    background: none;
    border: none;
    color: white;
    font-size: 2em;
    cursor: pointer;
    margin-right: 15px;
    display: block; /* Always visible */
    line-height: 0.5;
}

/* Sidebar Navigation */
.sidebar {
    width: 250px;
    background: #282828; /* Darker sidebar */
    padding: 1em 0;
    box-shadow: 2px 0 5px rgba(0, 0, 0, 0.5);
    flex-shrink: 0;
    /* Transition and Positioning for toggle effect */
    transition: margin-left 0.3s ease-in-out;
    margin-left: 0; /* Default: Visible */
}

/* State when sidebar is hidden */
.sidebar.hidden {
    margin-left: -250px;
}

/* Main Content Area */
.main-content-container {
    display: flex;
    flex-grow: 1;
    overflow-x: hidden; /* Prevent horizontal scroll when sidebar is hidden */
}

.main-content {
    flex-grow: 1;
    padding: 2em;
    overflow-y: auto;
    /* Ensure content expands when sidebar hides */
    transition: margin-left 0.3s ease-in-out;
}
/* When sidebar is hidden, main content uses full width */
.sidebar.hidden + .main-content {
    width: 100%; 
    margin-left: 0;
}

.page-section {
    display: none;
    animation: fadeIn 0.5s;
}
.page-section.active {
    display: block;
}
@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

/* Dashboard Cards (KPIs) - Same as before */
.dashboard-cards {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
    margin-bottom: 2em;
}
.card {
    background: #2f2f2f;
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
    text-align: center;
    transition: transform 0.3s;
}
.card:hover { transform: translateY(-5px); }
.card .value { font-size: 2.5em; font-weight: bold; color: #28a745; }
.card .label { font-size: 1em; color: #aaa; margin-top: 5px; }

/* Other styles (Tables, Buttons, Forms) are kept the same for brevity */
table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 1em;
    background: #2f2f2f;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
}
th, td {
    border: 1px solid #3a3a3a;
    padding: 0.8em;
    text-align: center;
    font-size: 0.9em;
}
th {
    background: #3a3a3a;
    color: #fff;
    text-transform: uppercase;
    font-weight: 600;
}
input, select {
    padding: 0.4em;
    margin: 0.3em;
    border-radius: 4px;
    border: 1px solid #555;
    background: #3a3a3a;
    color: #f0f0f0;
}
button {
    padding: 8px 12px;
    margin: 4px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-weight: bold;
    transition: background-color 0.3s;
}
button.edit { background: #007bff; color: white; }
button.delete { background: #dc3545; color: white; }
button.approve { background: #28a745; color: white; }
button.reject { background: #ffc107; color: black; }
.form-group {
    display: flex;
    gap: 15px;
    flex-wrap: wrap;
    align-items: center;
    padding: 15px;
    background: #3a3a3a;
    border-radius: 8px;
    margin-bottom: 15px;
}
.form-group label { color: #aaa; }
</style>
</head>
<body>

<header>
    <div style="display: flex; align-items: center;">
        <button class="hamburger" onclick="toggleSidebar()">â˜°</button>
        <h1>Admin Dashboard</h1>
    </div>
    <div>
        <a href="index.html" target="_blank" style="margin-right: 15px; color: #ffc107; text-decoration: none; font-weight: bold;">View Shop</a>
        <button onclick="logout()">Logout</button>
    </div>
</header>

<div class="main-content-container"> 
    <div id="sidebar" class="sidebar">
        <a href="#" class="active" onclick="showSection('dashboard', this)">ğŸ“Š Dashboard</a>
        
        <h3>Management</h3>
        <a href="#" onclick="showSection('vendor-management', this)">ğŸ‘¥ Vendors</a>
        <a href="#" onclick="showSection('product-management', this)">ğŸ“¦ Products</a>
        <a href="#" onclick="showSection('order-management', this)">ğŸ›’ Orders</a>
        <a href="#" onclick="showSection('promo-management', this)">ğŸ·ï¸ Promocodes</a>
        <a href="#" onclick="showSection('banner-management', this)">ğŸ–¼ï¸ Banners</a>
        <a href="#" onclick="showSection('customer-management', this)">ğŸ§‘ Customers</a>
    </div>

    <div class="main-content">
        
        <div id="dashboard" class="page-section active">
            <h2>Dashboard Overview</h2>
            <div class="dashboard-cards">
                <div class="card">
                    <div class="value" id="totalVendors">0</div>
                    <div class="label">Total Vendors</div>
                </div>
                <div class="card">
                    <div class="value" id="totalProducts">0</div>
                    <div class="label">Total Approved Products</div>
                </div>
                <div class="card">
                    <div class="value" id="totalOrders">0</div>
                    <div class="label">Total Orders</div>
                </div>
                <div class="card">
                    <div class="value" id="pendingApprovals">0</div>
                    <div class="label">Pending Approvals</div>
                </div>
            </div>
            
            <h3>Recent Pending Approvals</h3>
            <table id="pendingTable">
                <thead>
                    <tr><th>Type</th><th>Name</th><th>Date</th><th>Actions</th></tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
        
        <div id="vendor-management" class="page-section">
            <h2>Vendor Approvals & Management</h2>
            <table id="vendorTable">
                <thead>
                    <tr>
                        <th>ID</th><th>Name</th><th>Status</th><th>Promocode</th><th>Actions</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>

        <div id="product-management" class="page-section">
            <h2>Product Approvals & Management</h2>
            <table id="productTable">
                <thead>
                    <tr>
                        <th>Status</th><th>Name</th><th>Vendor</th><th>Price</th><th>Stock</th><th>Category</th><th>Assigned Promo</th><th>Actions</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>

        <div id="order-management" class="page-section">
            <h2>Order Management</h2>
            <table id="orderTable">
                <thead>
                    <tr>
                        <th>Order ID</th><th>Customer</th><th>Total</th><th>Promocode</th><th>Status</th><th>Actions</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>

        <div id="promo-management" class="page-section">
            <h2>Promocode Management</h2>
            <div id="promoForm">
                <h3>Add/Edit Promocode</h3>
                <input type="hidden" id="editPromoCode">
                <div class="form-group">
                    <label>Code:</label><input type="text" id="promoCode" placeholder="E.g., SALE20">
                    <label>Discount:</label><input type="number" id="promoDiscount" placeholder="Value (e.g., 20)">
                    <label>Type:</label>
                    <select id="promoType">
                        <option value="percent">Percentage (%)</option>
                        <option value="fixed">Fixed Amount ($)</option>
                    </select>
                    <label>Min. Order:</label><input type="number" id="promoMinOrder" value="0" min="0">
                </div>
                <button class="approve" onclick="savePromocode()">Save Promocode</button>
                <button class="reject" onclick="resetPromoForm()">Cancel</button>
            </div>

            <table id="promocodeTable">
                <thead>
                    <tr>
                        <th>Code</th><th>Discount</th><th>Type</th><th>Min. Order</th><th>Scope</th><th>Usage Count</th><th>Actions</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>

        <div id="banner-management" class="page-section">
            <h2>Banner Management (Carousel)</h2>
            <div id="bannerForm">
                <h3>Add/Edit Banner</h3>
                <input type="hidden" id="editBannerId">
                <div class="form-group">
                    <label>Image URL:</label><input type="url" id="bannerImageURL" placeholder="Image URL" style="width: 400px;">
                    <label>Link URL:</label><input type="url" id="bannerLinkURL" placeholder="Link (e.g., #categories)" style="width: 400px;">
                </div>
                <button class="approve" onclick="saveBanner()">Save Banner</button>
            </div>

            <table id="bannerTable">
                <thead>
                    <tr>
                        <th>Preview</th><th>Image URL</th><th>Link URL</th><th>Actions</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
        
        <div id="customer-management" class="page-section">
            <h2>Customers</h2>
            <table id="customerTable">
                <thead>
                    <tr>
                        <th>Username</th><th>WhatsApp</th><th>Address</th><th>Actions</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>

    </div>
</div>

<script>
// ======= ADMIN CREDENTIALS (for prompt login) =======
const ADMIN_CRED = {id:"admin",password:"admin123"};

// ======= DATA LOAD (Ensure all data models are loaded) =======
let vendors = JSON.parse(localStorage.getItem("vendors")||'[]');
let customers = JSON.parse(localStorage.getItem("customers")||'[]');
let products = JSON.parse(localStorage.getItem("products")||'[]');
let orders = JSON.parse(localStorage.getItem("orders")||'[]');
let masterPromocodes = JSON.parse(localStorage.getItem("masterPromocodes")||'[]');
let banners = JSON.parse(localStorage.getItem("banners")||'[]');
let promocodeUsage = JSON.parse(localStorage.getItem("promocodeUsage")||'{}');


// ======= SIDEBAR TOGGLE FUNCTION =======
function toggleSidebar() {
    const sidebar = document.getElementById('sidebar');
    sidebar.classList.toggle('hidden');
}


// ======= ADMIN LOGIN CHECK =======
let loggedAdmin = JSON.parse(localStorage.getItem("loggedAdmin")||'null');
if(!loggedAdmin){
Â  let username = prompt("Enter Admin ID:", ADMIN_CRED.id);
Â  let password = prompt("Enter Admin Password:", ADMIN_CRED.password);
Â  if(username===ADMIN_CRED.id && password===ADMIN_CRED.password){
Â  Â  loggedAdmin = ADMIN_CRED;
Â  Â  localStorage.setItem("loggedAdmin",JSON.stringify(loggedAdmin));
Â  } else { alert("Invalid Admin Credentials! Redirecting to shop."); window.location.href="index.html"; }
}

// ======= NAVIGATION AND UI CONTROL =======
function showSection(sectionId, element) {
    document.querySelectorAll('.page-section').forEach(sec => sec.classList.remove('active'));
    document.getElementById(sectionId).classList.add('active');
    
    document.querySelectorAll('.sidebar a').forEach(a => a.classList.remove('active'));
    if (element) {
        element.classList.add('active');
    }
    
    // Re-render data for the visible section
    initRender();
}

// ======= LOGOUT =======
function logout(){
Â  localStorage.removeItem("loggedAdmin");
Â  alert("Admin logged out");
Â  window.location.href="index.html";
}

// ======= DASHBOARD RENDER (KPIs and Pending Items) =======
function renderDashboard() {
    // 1. Calculate KPIs
    const approvedProducts = products.filter(p => p.status === 'Approved').length;
    const pendingProducts = products.filter(p => p.status === 'Pending').length;
    const pendingVendors = vendors.filter(v => v.status === 'Pending').length;
    
    // 2. Update Cards
    document.getElementById('totalVendors').innerText = vendors.length;
    document.getElementById('totalProducts').innerText = approvedProducts;
    document.getElementById('totalOrders').innerText = orders.length;
    document.getElementById('pendingApprovals').innerText = pendingProducts + pendingVendors;

    // 3. Render Recent Pending Approvals Table
    const pendingTableBody = document.querySelector("#pendingTable tbody");
    pendingTableBody.innerHTML = '';

    const recentPending = [
        ...vendors.filter(v => v.status === 'Pending').map(v => ({
            type: 'Vendor',
            name: v.name,
            date: 'N/A', 
            actions: `<button class="approve" onclick="approveVendorById('${v.id}')">Approve</button> <button class="reject" onclick="rejectVendorById('${v.id}')">Reject</button>`,
            sortId: v.id 
        })),
        ...products.filter(p => p.status === 'Pending').map(p => ({
            type: 'Product',
            name: p.name,
            date: 'N/A',
            actions: `<button class="approve" onclick="approveProductById('${p.id}')">Approve</button> <button class="reject" onclick="rejectProductById('${p.id}')">Reject</button>`,
            sortId: p.id
        }))
    ];

    recentPending.sort((a, b) => a.type.localeCompare(b.type) || a.sortId - b.sortId);

    recentPending.slice(0, 5).forEach(item => { 
        const tr = document.createElement('tr');
        tr.innerHTML = `
            <td>${item.type}</td>
            <td>${item.name}</td>
            <td>${item.date}</td>
            <td>${item.actions}</td>
        `;
        pendingTableBody.appendChild(tr);
    });

    // Helper functions for dashboard actions
    window.approveVendorById = (id) => {
        const index = vendors.findIndex(v => v.id === id);
        if (index !== -1) { approveVendor(index); }
    };
    window.rejectVendorById = (id) => {
        const index = vendors.findIndex(v => v.id === id);
        if (index !== -1) { rejectVendor(index); }
    };
    window.approveProductById = (id) => {
        const index = products.findIndex(p => p.id === id);
        if (index !== -1) { approveProduct(index); }
    };
    window.rejectProductById = (id) => {
        const index = products.findIndex(p => p.id === id);
        if (index !== -1) { rejectProduct(index); }
    };
}


// ======= UTILITIES, CRUD FUNCTIONS (Keep updated) =======

function saveAllData(){
Â  localStorage.setItem("vendors",JSON.stringify(vendors));
Â  localStorage.setItem("customers",JSON.stringify(customers));
Â  localStorage.setItem("products",JSON.stringify(products));
Â  localStorage.setItem("orders",JSON.stringify(orders));
Â  localStorage.setItem("masterPromocodes",JSON.stringify(masterPromocodes));
Â  localStorage.setItem("banners",JSON.stringify(banners));
}

function getVendorName(vendorId){
Â  return vendors.find(v=>v.id===vendorId)?.name || "Unknown Vendor";
}

// VENDOR CRUD 
function renderVendors(){
Â  const tbody = document.querySelector("#vendorTable tbody");
Â  tbody.innerHTML="";
Â  vendors.forEach((v,i)=>{
Â  Â  const tr=document.createElement("tr");
    const statusColor = v.status === 'Approved' ? '#28a745' : (v.status === 'Rejected' ? '#dc3545' : 'orange');
Â  Â  tr.innerHTML=`
Â  Â  Â  <td>${v.id}</td>
Â  Â  Â  <td>${v.name} (${v.whatsapp})</td>
Â  Â  Â  <td><span style="font-weight:bold; color:${statusColor}">${v.status}</span></td>
Â  Â  Â  <td>${v.promocode}</td>
Â  Â  Â  <td>
Â  Â  Â  Â  ${v.status!=='Approved'?`<button class="approve" onclick="approveVendor(${i})">Approve</button>`:""}
Â  Â  Â  Â  ${v.status!=='Rejected'?`<button class="reject" onclick="rejectVendor(${i})">Reject</button>`:""}
Â  Â  Â  Â  <button class="delete" onclick="deleteVendor(${i})">Delete</button>
Â  Â  Â  </td>
Â  Â  `;
Â  Â  tbody.appendChild(tr);
Â  });
}

function approveVendor(i){
Â  vendors[i].status="Approved";
Â  saveAllData();
Â  initRender(); 
}

function rejectVendor(i){
Â  vendors[i].status="Rejected";
Â  saveAllData();
Â  initRender(); 
}

function deleteVendor(i){
Â  if(confirm(`Delete vendor ${vendors[i].name}? This will NOT delete their products.`)){
Â  Â  vendors.splice(i,1);
Â  Â  saveAllData();
Â  Â  initRender();
Â  }
}


// PRODUCT CRUD 
function renderProductsTable(){
Â  const tbody = document.querySelector("#productTable tbody");
Â  tbody.innerHTML="";
Â  products.forEach((p,i)=>{
Â  Â  const vendorName = getVendorName(p.vendorId);
Â  Â  const tr=document.createElement("tr");
Â  Â  const statusColor = p.status === 'Approved' ? '#28a745' : (p.status === 'Rejected' ? '#dc3545' : 'orange');

Â  Â  tr.innerHTML=`
Â  Â  Â  <td><span style="font-weight:bold; color:${statusColor}">${p.status}</span></td>
Â  Â  Â  <td>${p.name}</td>
Â  Â  Â  <td>${vendorName}</td>
Â  Â  Â  <td>$${p.price.toFixed(2)}</td>
Â  Â  Â  <td>${p.stock}</td>
Â  Â  Â  <td>${p.category}</td>
Â  Â  Â  <td>${p.promoCodeAssigned || 'None'}</td>
Â  Â  Â  <td>
Â  Â  Â  Â  ${p.status!=='Approved'?`<button class="approve" onclick="approveProduct(${i})">Approve</button>`:""}
Â  Â  Â  Â  ${p.status!=='Rejected'?`<button class="reject" onclick="rejectProduct(${i})">Reject</button>`:""}
Â  Â  Â  Â  <button class="delete" onclick="deleteProduct(${i})">Delete</button>
Â  Â  Â  </td>
Â  Â  `;
Â  Â  tbody.appendChild(tr);
Â  });
}

function approveProduct(i){
Â  products[i].status="Approved";
Â  saveAllData();
Â  initRender();
}

function rejectProduct(i){
Â  products[i].status="Rejected";
Â  saveAllData();
Â  initRender();
}

function deleteProduct(i){
Â  if(confirm(`Delete product ${products[i].name}?`)){
Â  Â  products.splice(i,1);
Â  Â  saveAllData();
Â  Â  initRender();
Â  }
}

// PROMOCODE CRUD 
function resetPromoForm() {
Â  document.getElementById('editPromoCode').value = '';
Â  document.getElementById('promoCode').value = '';
Â  document.getElementById('promoDiscount').value = '';
Â  document.getElementById('promoType').value = 'percent';
Â  document.getElementById('promoMinOrder').value = 0;
}

function savePromocode(){
Â  const code = document.getElementById('promoCode').value.trim().toUpperCase();
Â  const discount = parseFloat(document.getElementById('promoDiscount').value);
Â  const type = document.getElementById('promoType').value;
Â  const minOrder = parseFloat(document.getElementById('promoMinOrder').value);
Â  const editCode = document.getElementById('editPromoCode').value;

Â  if (!code || isNaN(discount) || discount <= 0 || isNaN(minOrder) || minOrder < 0) {
Â  Â  alert("Fill all fields correctly.");
Â  Â  return;
Â  }

Â  const newPromo = {
Â  Â  code,
Â  Â  discount,
Â  Â  type,
Â  Â  minOrder,
Â  Â  scope: 'global',
Â  Â  expiry: '2026-12-31'
Â  };

Â  if (editCode) {
Â  Â  const index = masterPromocodes.findIndex(p => p.code === editCode);
Â  Â  if (index !== -1) {
Â  Â  Â  masterPromocodes[index] = { ...masterPromocodes[index], ...newPromo };
Â  Â  }
Â  } else {
Â  Â  if (masterPromocodes.some(p => p.code === code)) {
Â  Â  Â  alert("Promocode already exists.");
Â  Â  Â  return;
Â  Â  }
Â  Â  masterPromocodes.push(newPromo);
Â  }

Â  saveAllData();
Â  initRender();
Â  resetPromoForm();
}

function editPromocode(code){
Â  const promo = masterPromocodes.find(p => p.code === code);
Â  if (promo && promo.scope === 'global') {
Â  Â  document.getElementById('editPromoCode').value = promo.code;
Â  Â  document.getElementById('promoCode').value = promo.code;
Â  Â  document.getElementById('promoDiscount').value = promo.discount;
Â  Â  document.getElementById('promoType').value = promo.type;
Â  Â  document.getElementById('promoMinOrder').value = promo.minOrder;
Â  } else if (promo && promo.scope === 'vendor') {
Â  Â  alert("Vendor-specific promo codes cannot be edited by Admin here.");
Â  }
}

function deletePromocode(code){
Â  if(confirm(`Delete promocode ${code}?`)){
Â  Â  masterPromocodes = masterPromocodes.filter(p => p.code !== code);
Â  Â  saveAllData();
Â  Â  initRender();
Â  }
}


function renderPromocodes(){
Â  const tbody = document.querySelector("#promocodeTable tbody");
Â  tbody.innerHTML="";
Â  masterPromocodes.forEach(p=>{
Â  Â  const usageCount = promocodeUsage[p.code] || 0;
Â  Â  const tr=document.createElement("tr");
Â  Â  const scopeInfo = p.scope === 'vendor' ? `Vendor: ${p.vendorId}` : 'Global';
Â  Â  tr.innerHTML=`
Â  Â  Â  <td>${p.code}</td>
Â  Â  Â  <td>${p.discount} ${p.type === 'percent' ? '%' : '$ Fixed'}</td>
Â  Â  Â  <td>$${p.minOrder.toFixed(2)}</td>
Â  Â  Â  <td>${scopeInfo}</td>
Â  Â  Â  <td>${usageCount}</td>
Â  Â  Â  <td>
Â  Â  Â  Â  <button class="edit" onclick="editPromocode('${p.code}')" ${p.scope === 'vendor' ? 'disabled' : ''}>Edit</button>
Â  Â  Â  Â  <button class="delete" onclick="deletePromocode('${p.code}')">Delete</button>
Â  Â  Â  </td>
Â  Â  `;
Â  Â  tbody.appendChild(tr);
Â  });
}

// BANNER CRUD 
function saveBanner(){
Â  const imageURL = document.getElementById('bannerImageURL').value.trim();
Â  const linkURL = document.getElementById('bannerLinkURL').value.trim();
Â  const editId = parseInt(document.getElementById('editBannerId').value);

Â  if (!imageURL) {
Â  Â  alert("Image URL is required.");
Â  Â  return;
Â  }

Â  if (editId) {
Â  Â  const index = banners.findIndex(b => b.id === editId);
Â  Â  if (index !== -1) {
Â  Â  Â  banners[index].imageURL = imageURL;
Â  Â  Â  banners[index].link = linkURL || '#';
Â  Â  }
Â  } else {
Â  Â  const newId = banners.length > 0 ? Math.max(...banners.map(b => b.id)) + 1 : 1;
Â  Â  banners.push({ id: newId, imageURL, link: linkURL || '#' });
Â  }

Â  saveAllData();
Â  initRender();
Â  document.getElementById('editBannerId').value = '';
Â  document.getElementById('bannerImageURL').value = '';
Â  document.getElementById('bannerLinkURL').value = '';
}

function editBanner(id){
Â  const banner = banners.find(b => b.id === id);
Â  if (banner) {
Â  Â  document.getElementById('editBannerId').value = banner.id;
Â  Â  document.getElementById('bannerImageURL').value = banner.imageURL;
Â  Â  document.getElementById('bannerLinkURL').value = banner.link;
Â  }
}

function deleteBanner(id){
Â  if(confirm(`Delete banner ${id}?`)){
Â  Â  banners = banners.filter(b => b.id !== id);
Â  Â  saveAllData();
Â  Â  initRender();
Â  }
}

function renderBanners(){
Â  const tbody = document.querySelector("#bannerTable tbody");
Â  tbody.innerHTML="";
Â  banners.forEach(b=>{
Â  Â  const tr=document.createElement("tr");
Â  Â  tr.innerHTML=`
Â  Â  Â  <td><img src="${b.imageURL}" style="width:100px; height:50px; object-fit:cover;"></td>
Â  Â  Â  <td>${b.imageURL}</td>
Â  Â  Â  <td><a href="${b.link}" target="_blank" style="color:#007bff;">${b.link}</a></td>
Â  Â  Â  <td>
Â  Â  Â  Â  <button class="edit" onclick="editBanner(${b.id})">Edit</button>
Â  Â  Â  Â  <button class="delete" onclick="deleteBanner(${b.id})">Delete</button>
Â  Â  Â  </td>
Â  Â  `;
Â  Â  tbody.appendChild(tr);
Â  });
}


// ORDER CRUD 
function renderOrders(){
Â  const tbody = document.querySelector("#orderTable tbody");
Â  tbody.innerHTML="";
Â  orders.forEach((o,i)=>{
Â  Â  const statusColor = o.status === 'Completed' ? '#28a745' : (o.status === 'Cancelled' ? '#dc3545' : 'orange');

Â  Â  tr=document.createElement("tr");
Â  Â  tr.innerHTML=`
Â  Â  Â  <td>#${o.id} (${o.date ? new Date(o.date).toLocaleDateString() : 'N/A'})</td>
Â  Â  Â  <td>${o.customer}</td>
Â  Â  Â  <td>$${o.total}</td>
Â  Â  Â  <td>${o.promocode}</td>
Â  Â  Â  <td><span style="font-weight:bold; color:${statusColor}">${o.status}</span></td>
Â  Â  Â  <td>
Â  Â  Â  Â  <select onchange="updateOrderStatus(${i},this.value)">
Â  Â  Â  Â  Â  <option value="Pending" ${o.status==="Pending"?"selected":""}>Pending</option>
Â  Â  Â  Â  Â  <option value="Completed" ${o.status==="Completed"?"selected":""}>Completed</option>
Â  Â  Â  Â  Â  <option value="Cancelled" ${o.status==="Cancelled"?"selected":""}>Cancelled</option>
Â  Â  Â  Â  </select>
Â  Â  Â  </td>
Â  Â  `;
Â  Â  tbody.appendChild(tr);
Â  });
}

function updateOrderStatus(i,status){
Â  orders[i].status=status;
Â  saveAllData();
Â  initRender();
}


// CUSTOMER CRUD 
function renderCustomers(){
Â  const tbody = document.querySelector("#customerTable tbody");
Â  tbody.innerHTML="";
Â  customers.forEach((c,i)=>{
Â  Â  const tr=document.createElement("tr");
Â  Â  tr.innerHTML=`
Â  Â  Â  <td>${c.username}</td>
Â  Â  Â  <td>${c.whatsapp}</td>
Â  Â  Â  <td>${c.address}</td>
Â  Â  Â  <td><button class="delete" onclick="deleteCustomer(${i})">Delete</button></td>
Â  Â  `;
Â  Â  tbody.appendChild(tr);
Â  });
}

function deleteCustomer(i){
Â  if(confirm(`Delete customer ${customers[i].username}?`)){
Â  Â  customers.splice(i,1);
Â  Â  saveAllData();
Â  Â  initRender();
Â  }
}


// ======= INITIAL RENDER ALL SECTIONS =======
function initRender() {
    // Reload data models before rendering
    vendors = JSON.parse(localStorage.getItem("vendors")||'[]');
    products = JSON.parse(localStorage.getItem("products")||'[]');
    orders = JSON.parse(localStorage.getItem("orders")||'[]');
    masterPromocodes = JSON.parse(localStorage.getItem("masterPromocodes")||'[]');
    banners = JSON.parse(localStorage.getItem("banners")||'[]');
    promocodeUsage = JSON.parse(localStorage.getItem("promocodeUsage")||'{}');
    customers = JSON.parse(localStorage.getItem("customers")||'[]');


Â  renderDashboard(); // Always render dashboard first
Â  renderVendors();
Â  renderCustomers();
Â  renderProductsTable();
Â  renderOrders();
Â  renderPromocodes();
Â  renderBanners();
}

initRender();

</script>
</body>
</html>
