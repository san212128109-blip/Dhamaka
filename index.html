<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dhamaka Shop</title>
<style>
body{font-family:Arial,sans-serif;background:#f8f9fa;color:#212529;margin:0;padding:0;}
header{background:#28a745;color:white;padding:1em;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;}
header h1{margin:0;}
nav a{color:white;margin-left:1em;text-decoration:none;font-weight:bold;}
nav a:hover{color:#ffc107;}
.container{padding:1em;}
.product-list{display:flex;flex-wrap:wrap;gap:1em;justify-content:center;margin-top:1em;}
.product{border:1px solid #28a745;border-radius:12px;padding:1em;width:200px;text-align:center;background:#fff;box-shadow:2px2px10px rgba(0,0,0,0.1);}
.product img{width:100px;height:100px;object-fit:cover;margin-bottom:10px;border-radius:8px;}
button{background:#28a745;color:white;border:none;padding:0.5em 1em;border-radius:5px;cursor:pointer;margin-top:0.5em;}
button:hover{background:#218838;}
</style>
</head>
<body>

<header>
<h1>Dhamaka Shop</h1>
<nav>
<a href="index.html">Home</a>
<a href="vendor.html">Vendor Panel</a>
<a href="admin.html">Admin Panel</a>
</nav>
</header>

<div class="container">
<h2>Products</h2>
<div class="product-list" id="productList"></div>
</div>

<script>
let products=JSON.parse(localStorage.getItem('products')||'[]');

function renderProducts(){
    let list=document.getElementById('productList');list.innerHTML='';
    if(products.length===0){list.innerHTML='<p>No products available.</p>';return;}
    products.forEach(p=>{
        const imageUrl=p.imageURL||(p.image && p.image.startsWith('http') ? p.image : "https://via.placeholder.com/100?text=No+Image");
        let div=document.createElement('div');div.className='product';
        div.innerHTML=`<img src="${imageUrl}" alt="${p.name}">
        <h3>${p.name}</h3>
        <p>Category: ${p.category}</p>
        <p>Price: $${p.price.toFixed(2)}</p>
        <p>Stock: ${p.stock}</p>
        <button onclick="buyProduct(${p.id})" ${p.stock<=0?'disabled':''}>Buy</button>`;
        list.appendChild(div);
    });
}

function buyProduct(id){
    let p=products.find(pr=>pr.id===id);
    if(!p||p.stock<=0){alert("Product out of stock");return;}
    let name=prompt("Enter your name:");if(!name)return;
    let whatsapp=prompt("Enter WhatsApp number:");if(!whatsapp)return;
    let address=prompt("Enter delivery address:");if(!address)return;
    let quantity=parseInt(prompt(`Enter quantity (Available: ${p.stock})`));if(isNaN(quantity)||quantity<=0||quantity>p.stock){alert("Invalid quantity");return;}
    let orders=JSON.parse(localStorage.getItem('orders')||'[]');
    let orderId=orders.length>0?Math.max(...orders.map(o=>o.id))+1:1;
    orders.push({id:orderId,customerName:name,customerWhatsapp:whatsapp,customerAddress:address,products:[{id:p.id,name:p.name,quantity:quantity,price:p.price}],total:p.price*quantity,date:new Date().toLocaleString(),status:'Pending'});
    localStorage.setItem('orders',JSON.stringify(orders));
    p.stock-=quantity;
    localStorage.setItem('products',JSON.stringify(products));
    alert("Order placed successfully!");
    renderProducts();
}

renderProducts();
</script>

</body>
</html>
